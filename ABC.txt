import pandas as pd

# Load the data into a DataFrame (assuming a CSV file, replace with your actual data source)
df = pd.read_csv('HU_LIMITS_POST.csv')

# Apply the filtering conditions
filtered_df = df[
    (
        (df['LIMIT_AMOUNT'] > 0) &
        (df['MAKER_ID'] != 'RAPUPLD') &
        (df['RECORD_STAT'] == 'O')
    ) |
    (
        (df['DAYLIGHT_OD_LIMIT'] > 0) &
        (df['MAKER_ID'] != 'RAPUPLD') &
        (df['RECORD_STAT'] == '0')
    )
]

# Create the 'KEY' column by concatenating 'LIAB_ID', 'LINE_CD', and 'LINE_SERIAL'
filtered_df['KEY'] = filtered_df['LIAB_ID'].astype(str) + filtered_df['LINE_CD'].astype(str) + filtered_df['LINE_SERIAL'].astype(str)

# Select the desired columns
selected_columns = [
    'LIAB_ID', 'LINE_CD', 'LINE_SERIAL', 'MAIN_LINE', 'AVAILABILITY_FLAG', 'UTILISATION',
    'LIMIT_AMOUNT', 'DAYLIGHT_OD_LIMIT', 'INTERNAL_REMARKS', 'MAKER_ID', 'KEY', 'RECORD_STAT',
    'LINE_START_DATE', 'LINE_EXPIRY_DATE', 'CHECKER_DT_STAMP'
]

result_df = filtered_df[selected_columns]

# Display the resulting DataFrame
print(result_df)
